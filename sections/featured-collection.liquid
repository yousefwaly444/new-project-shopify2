<!-- Banner Section - Desktop -->
{% if section.settings.show_banner and section.settings.banner_image %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-4 hidden md:flex md:flex-col">
<div class="relative w-full overflow-hidden rounded-3xl" style="height: {{ section.settings.banner_height }}px; border-radius: 1.5rem;">
    <img 
        src="{{ section.settings.banner_image | image_url: width: 1920 }}" 
        alt="{{ section.settings.banner_heading | escape }}"
        width="1920"
        height="500"
        class="w-full h-full object-cover"
        style="border-radius: inherit;"
        loading="lazy"
    >
    
    <!-- Banner Overlay -->
    <div class="absolute inset-0 flex items-center justify-center rounded-3xl" style="border-radius: inherit;">
        <div class="text-center px-4">
            {% if section.settings.banner_heading != blank %}
                <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">{{ section.settings.banner_heading }}</h1>
            {% endif %}
            
            {% if section.settings.banner_subheading != blank %}
                <p class="text-xl md:text-2xl text-white mb-6">{{ section.settings.banner_subheading }}</p>
            {% endif %}
            
            {% if section.settings.banner_button_text != blank and section.settings.banner_button_link != blank %}
                <a href="{{ section.settings.banner_button_link }}" class="inline-block px-8 py-3 bg-black text-white font-semibold rounded-2xl hover:bg-gray-800 transition-colors">
                    {{ section.settings.banner_button_text }}
                </a>
            {% endif %}
        </div>
    </div>
</div>
</div>
{% endif %}

<!-- Banner Section - Mobile -->
{% if section.settings.show_banner and section.settings.mobile_banner_image %}
<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 mb-4 mobile-banner-wrapper" style="display: flex;">
<div class="relative w-full overflow-hidden rounded-3xl" style="height: {{ section.settings.mobile_banner_height }}px; border-radius: 1.5rem;">
    <img 
        src="{{ section.settings.mobile_banner_image | image_url: width: 768 }}" 
        alt="{{ section.settings.banner_heading | escape }}"
        width="768"
        height="400"
        class="w-full h-full object-cover"
        style="border-radius: inherit;"
        loading="lazy"
    >
    
    <!-- Banner Overlay -->
    <div class="absolute inset-0 flex items-center justify-center rounded-3xl" style="border-radius: inherit;">
        <div class="text-center px-4">
            {% if section.settings.banner_heading != blank %}
                <h1 class="text-2xl md:text-5xl font-bold text-white mb-4">{{ section.settings.banner_heading }}</h1>
            {% endif %}
            
            {% if section.settings.banner_subheading != blank %}
                <p class="text-lg md:text-2xl text-white mb-6">{{ section.settings.banner_subheading }}</p>
            {% endif %}
            
            {% if section.settings.banner_button_text != blank and section.settings.banner_button_link != blank %}
                <a href="{{ section.settings.banner_button_link }}" class="inline-block px-6 py-2 bg-black text-white font-semibold rounded-2xl hover:bg-gray-800 transition-colors">
                    {{ section.settings.banner_button_text }}
                </a>
            {% endif %}
        </div>
    </div>
</div>
</div>
{% endif %}

<style>
  @media (min-width: 768px) {
    .mobile-banner-wrapper {
      display: none !important;
    }
  }
</style>

{% assign has_any_banner = false %}
{% if section.settings.show_banner %}
  {% if section.settings.banner_image or section.settings.mobile_banner_image %}
    {% assign has_any_banner = true %}
  {% endif %}
{% endif %}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 {% if has_any_banner %}pt-6{% else %}pt-10{% endif %} pb-10">
    {% if section.settings.show_title and section.settings.title != blank %}
        <h2 class="text-3xl font-bold text-gray-900 text-center mb-8">{{ section.settings.title }}</h2>
    {% endif %}

    <div class="relative">
        <!-- Carousel Navigation - Prev (desktop only) -->
        <button type="button" id="carousel-prev-{{ section.id }}" class="hidden md:flex absolute left-0 top-1/2 -translate-y-1/2 -translate-x-2 z-10 w-10 h-10 bg-white border border-gray-200 rounded-full shadow-md items-center justify-center hover:bg-gray-50 transition-colors" aria-label="Previous">
            <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
        </button>
        
        <!-- Carousel Navigation - Next (desktop only) -->
        <button type="button" id="carousel-next-{{ section.id }}" class="hidden md:flex absolute right-0 top-1/2 -translate-y-1/2 translate-x-2 z-10 w-10 h-10 bg-white border border-gray-200 rounded-full shadow-md items-center justify-center hover:bg-gray-50 transition-colors" aria-label="Next">
            <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        </button>

        <!-- Carousel Container -->
        <div id="carousel-{{ section.id }}" class="flex overflow-x-auto gap-6 pb-4 scroll-smooth snap-x snap-mandatory hide-scrollbar" style="scrollbar-width: none; -ms-overflow-style: none;">
            {% if section.settings.featured_collection != blank %}
                {% for product in section.settings.featured_collection.products limit: section.settings.number_of_products_to_show %}
                    {% render 'product-card', product_product: product %}
                {% else %}
                    {% for item in (1..4) %}
                        {% render 'product-card-placeholder' %}
                    {% endfor %}
                {% endfor %}
            {% else %}
                {% for item in (1..4) %}
                    {% render 'product-card-placeholder' %}
                {% endfor %}
            {% endif %}
        </div>
    </div>
</div>

<style>
  #carousel-{{ section.id }} .shrink-0 { scroll-snap-align: start; }
  .hide-scrollbar::-webkit-scrollbar { display: none; }
</style>

<script>
  (function() {
    const carousel = document.getElementById('carousel-{{ section.id }}');
    const prevBtn = document.getElementById('carousel-prev-{{ section.id }}');
    const nextBtn = document.getElementById('carousel-next-{{ section.id }}');
    
    if (!carousel || !prevBtn || !nextBtn) return;
    
    const cardWidth = 224;
    const gap = 24;
    const scrollAmount = cardWidth + gap;
    
    prevBtn.addEventListener('click', function() {
      carousel.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
    });
    
    nextBtn.addEventListener('click', function() {
      carousel.scrollBy({ left: scrollAmount, behavior: 'smooth' });
    });
  })();
</script>



{% schema %}
{
    "name": "Featured Collection",
    "settings": [
        {
            "type": "header",
            "content": "Banner Settings"
        },
        {
            "type": "checkbox",
            "id": "show_banner",
            "label": "Show banner",
            "default": true
        },
        {
            "type": "image_picker",
            "id": "banner_image",
            "label": "Desktop banner image"
        },
        {
            "type": "range",
            "id": "banner_height",
            "min": 300,
            "max": 800,
            "step": 50,
            "default": 500,
            "label": "Desktop banner height (px)"
        },
        {
            "type": "image_picker",
            "id": "mobile_banner_image",
            "label": "Mobile banner image"
        },
        {
            "type": "range",
            "id": "mobile_banner_height",
            "min": 200,
            "max": 600,
            "step": 50,
            "default": 400,
            "label": "Mobile banner height (px)"
        },
        {
            "type": "text",
            "id": "banner_heading",
            "label": "Banner heading",
            "default": "Special Collection"
        },
        {
            "type": "text",
            "id": "banner_subheading",
            "label": "Banner subheading",
            "default": "Limited time offers"
        },
        {
            "type": "text",
            "id": "banner_button_text",
            "label": "Button text",
            "default": "Shop Now"
        },
        {
            "type": "url",
            "id": "banner_button_link",
            "label": "Button link"
        },
        {
            "type": "header",
            "content": "Collection Settings"
        },
        {
            "type": "checkbox",
            "id": "show_title",
            "label": "Show title",
            "default": false
        },
        {
            "type": "text",
            "id": "title",
            "default": "Featured Collection",
            "label": "Collection title"
        },
        {
            "type": "collection",
            "id": "featured_collection",
            "label": "Collection"
        },
        {
            "type": "range",
            "id": "number_of_products_to_show",
            "min": 2,
            "max": 12,
            "default": 4,
            "step": 2,
            "label": "Number of products to show"
        }
    ],
    "presets": [
        {
            "name": "Featured Collection"
        }
    ]
}
{% endschema %}